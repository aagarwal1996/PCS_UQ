/scratch/users/aa3797/conda/envs/pcs_uq/lib/python3.13/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. OF ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/scratch/users/aa3797/conda/envs/pcs_uq/lib/python3.13/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. OF ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/scratch/users/aa3797/conda/envs/pcs_uq/lib/python3.13/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. OF ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/scratch/users/aa3797/conda/envs/pcs_uq/lib/python3.13/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. OF ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
Training RandomForest models:   0%|          | 0/500 [00:00<?, ?it/s]Training RandomForest models:   0%|          | 1/500 [00:13<1:50:45, 13.32s/it]Training RandomForest models:   0%|          | 2/500 [00:26<1:49:04, 13.14s/it]Training RandomForest models:   1%|          | 3/500 [00:39<1:49:54, 13.27s/it]Training RandomForest models:   1%|          | 4/500 [00:53<1:49:51, 13.29s/it]Training RandomForest models:   1%|          | 5/500 [01:11<2:05:47, 15.25s/it]Training RandomForest models:   1%|          | 6/500 [01:27<2:07:45, 15.52s/it]Training RandomForest models:   1%|▏         | 7/500 [01:42<2:04:31, 15.15s/it]Training RandomForest models:   2%|▏         | 8/500 [01:57<2:04:04, 15.13s/it]Training RandomForest models:   2%|▏         | 9/500 [02:11<2:00:38, 14.74s/it]Training RandomForest models:   2%|▏         | 10/500 [02:26<2:00:59, 14.82s/it]Training RandomForest models:   2%|▏         | 11/500 [02:43<2:07:30, 15.65s/it]Training RandomForest models:   2%|▏         | 12/500 [02:57<2:02:03, 15.01s/it]Training RandomForest models:   3%|▎         | 13/500 [03:13<2:04:35, 15.35s/it]Training RandomForest models:   3%|▎         | 14/500 [03:29<2:05:26, 15.49s/it]Training RandomForest models:   3%|▎         | 15/500 [03:45<2:06:49, 15.69s/it]Training RandomForest models:   3%|▎         | 16/500 [04:02<2:11:03, 16.25s/it]Training RandomForest models:   3%|▎         | 17/500 [04:19<2:11:20, 16.32s/it]Training RandomForest models:   4%|▎         | 18/500 [04:35<2:09:25, 16.11s/it]Training RandomForest models:   4%|▍         | 19/500 [04:49<2:04:48, 15.57s/it]Training RandomForest models:   4%|▍         | 20/500 [05:05<2:05:55, 15.74s/it]Training RandomForest models:   4%|▍         | 21/500 [05:23<2:10:13, 16.31s/it]Training RandomForest models:   4%|▍         | 22/500 [05:39<2:09:30, 16.26s/it]Training RandomForest models:   5%|▍         | 23/500 [05:54<2:06:22, 15.90s/it]Training RandomForest models:   5%|▍         | 24/500 [06:09<2:05:38, 15.84s/it]Training RandomForest models:   5%|▌         | 25/500 [06:26<2:07:57, 16.16s/it]Training RandomForest models:   5%|▌         | 26/500 [06:43<2:09:31, 16.40s/it]Training RandomForest models:   5%|▌         | 27/500 [06:58<2:05:56, 15.97s/it]Training RandomForest models:   6%|▌         | 28/500 [07:12<2:00:53, 15.37s/it]Training RandomForest models:   6%|▌         | 29/500 [07:29<2:02:57, 15.66s/it]Training RandomForest models:   6%|▌         | 30/500 [07:45<2:05:06, 15.97s/it]Training RandomForest models:   6%|▌         | 31/500 [08:01<2:05:05, 16.00s/it]Training RandomForest models:   6%|▋         | 32/500 [08:17<2:03:36, 15.85s/it]Training RandomForest models:   7%|▋         | 33/500 [08:31<1:58:59, 15.29s/it]Training RandomForest models:   7%|▋         | 34/500 [08:47<1:59:59, 15.45s/it]Training RandomForest models:   7%|▋         | 35/500 [09:00<1:55:35, 14.92s/it]Training RandomForest models:   7%|▋         | 36/500 [09:15<1:55:01, 14.87s/it]Training RandomForest models:   7%|▋         | 37/500 [09:32<1:59:56, 15.54s/it]Training RandomForest models:   7%|▋         | 37/500 [09:40<2:01:02, 15.69s/it]
joblib.externals.loky.process_executor._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/scratch/users/aa3797/conda/envs/pcs_uq/lib/python3.13/site-packages/joblib/_utils.py", line 72, in __call__
    return self.func(**kwargs)
           ~~~~~~~~~^^^^^^^^^^
  File "/scratch/users/aa3797/conda/envs/pcs_uq/lib/python3.13/site-packages/joblib/parallel.py", line 598, in __call__
    return [func(*args, **kwargs)
            ~~~~^^^^^^^^^^^^^^^^^
  File "/scratch/users/aa3797/conda/envs/pcs_uq/lib/python3.13/site-packages/sklearn/utils/parallel.py", line 136, in __call__
    return self.function(*args, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/scratch/users/aa3797/conda/envs/pcs_uq/lib/python3.13/site-packages/sklearn/ensemble/_forest.py", line 192, in _parallel_build_trees
    tree._fit(
    ~~~~~~~~~^
        X,
        ^^
    ...<3 lines>...
        missing_values_in_feature_mask=missing_values_in_feature_mask,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/scratch/users/aa3797/conda/envs/pcs_uq/lib/python3.13/site-packages/sklearn/tree/_classes.py", line 472, in _fit
    builder.build(self.tree_, X, y, sample_weight, missing_values_in_feature_mask)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "_tree.pyx", line 172, in sklearn.tree._tree.DepthFirstTreeBuilder.build
  File "_tree.pyx", line 287, in sklearn.tree._tree.DepthFirstTreeBuilder.build
  File "_tree.pyx", line 942, in sklearn.tree._tree.Tree._add_node
  File "_tree.pyx", line 911, in sklearn.tree._tree.Tree._resize_c
  File "_utils.pyx", line 35, in sklearn.tree._utils.safe_realloc
MemoryError: could not allocate 11632640 bytes
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/accounts/campus/aa3797/PhD/PCS_UQ/experiments/scripts/run_classification_exp.py", line 145, in <module>
    run_classification_experiments(dataset_name=args.dataset, seed=args.seed, uq_method=uq_method, uq_method_name = args.UQ_method, method_name=method_name, train_size=args.train_size)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/accounts/campus/aa3797/PhD/PCS_UQ/experiments/scripts/run_classification_exp.py", line 65, in run_classification_experiments
    uq_method.fit(X_train, y_train)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/accounts/campus/aa3797/PhD/PCS_UQ/src/PCS/classification/multi_class_pcs_oob.py", line 67, in fit
    self._train_top_k(X, y)
    ~~~~~~~~~~~~~~~~~^^^^^^
  File "/accounts/campus/aa3797/PhD/PCS_UQ/src/PCS/classification/multi_class_pcs_oob.py", line 124, in _train_top_k
    bootstrap_model.fit(X_boot, y_boot)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/scratch/users/aa3797/conda/envs/pcs_uq/lib/python3.13/site-packages/sklearn/base.py", line 1473, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "/scratch/users/aa3797/conda/envs/pcs_uq/lib/python3.13/site-packages/sklearn/ensemble/_forest.py", line 489, in fit
    trees = Parallel(
    ...<2 lines>...
        prefer="threads",
    )(
        delayed(_parallel_build_trees)(
    ...<12 lines>...
        for i, t in enumerate(trees)
    )
  File "/scratch/users/aa3797/conda/envs/pcs_uq/lib/python3.13/site-packages/sklearn/utils/parallel.py", line 74, in __call__
    return super().__call__(iterable_with_config)
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/users/aa3797/conda/envs/pcs_uq/lib/python3.13/site-packages/joblib/parallel.py", line 2007, in __call__
    return output if self.return_generator else list(output)
                                                ~~~~^^^^^^^^
  File "/scratch/users/aa3797/conda/envs/pcs_uq/lib/python3.13/site-packages/joblib/parallel.py", line 1650, in _get_outputs
    yield from self._retrieve()
  File "/scratch/users/aa3797/conda/envs/pcs_uq/lib/python3.13/site-packages/joblib/parallel.py", line 1754, in _retrieve
    self._raise_error_fast()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/scratch/users/aa3797/conda/envs/pcs_uq/lib/python3.13/site-packages/joblib/parallel.py", line 1789, in _raise_error_fast
    error_job.get_result(self.timeout)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/scratch/users/aa3797/conda/envs/pcs_uq/lib/python3.13/site-packages/joblib/parallel.py", line 745, in get_result
    return self._return_or_raise()
           ~~~~~~~~~~~~~~~~~~~~~^^
  File "/scratch/users/aa3797/conda/envs/pcs_uq/lib/python3.13/site-packages/joblib/parallel.py", line 763, in _return_or_raise
    raise self._result
MemoryError: could not allocate 11632640 bytes
